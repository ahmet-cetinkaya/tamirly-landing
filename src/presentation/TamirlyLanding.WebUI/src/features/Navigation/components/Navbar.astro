---
import MobileMenu from "./MobileMenu";
import Button from "@tamirly-landing-webui/shared/components/Button";
import LocaleSwitcher from "@tamirly-landing-webui/shared/components/LocaleSwitcher";
import ThemeSwitcher from "@tamirly-landing-webui/shared/components/ThemeSwitcher";
import { APP_DOWNLOAD_LINK } from "@tamirly-landing-webui/shared/constants";

import { i18nInstance } from "@tamirly-landing-webui/shared/i18n/instance";
import { TranslationKeys } from "@tamirly-landing-webui/shared/i18n/enums/TranslationKeys";
import type { Locales } from "@tamirly-landing-webui/shared/i18n/enums/Locales";
import { Locales as LocalesEnum } from "@tamirly-landing-webui/shared/i18n/enums/Locales";

interface Props {
  locale?: Locales;
}

const { locale = LocalesEnum.EN } = Astro.props;

const t = (key: TranslationKeys) => i18nInstance.translate(locale, key);

const links = [
  { label: t(TranslationKeys.NAV_FEATURES), href: "#features" },
  { label: t(TranslationKeys.NAV_HOW_IT_WORKS), href: "#how-it-works" },
  { label: t(TranslationKeys.NAV_SUPPORTED_BRANDS), href: "#brands" },
];
---

<nav
  transition:persist
  class="fixed w-full z-50 transition-all duration-300 border-b border-border-color bg-background/90 backdrop-blur-md"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-20">
      <!-- Logo -->
      <a href={locale === LocalesEnum.TR ? "/tr/" : "/"} class="flex items-center gap-3">
        <img alt="Tamirly Icon" class="w-10 h-10 object-contain" src="/favicon.svg" />
        <span class="text-2xl font-bold tracking-tight text-primary">Tamirly</span>
      </a>

      <!-- Desktop Menu -->
      <div class="hidden md:flex space-x-8">
        {
          links.map((link) => (
            <a class="text-text-muted hover:text-primary transition-colors text-sm font-medium" href={link.href}>
              {link.label}
            </a>
          ))
        }
      </div>

      <!-- Actions Section -->
      <div class="flex items-center gap-2 sm:gap-4">
        <ThemeSwitcher client:load />
        <LocaleSwitcher client:load initialLocale={locale} currentPath={Astro.url.pathname} />

        <div class="hidden md:flex">
          <Button href={APP_DOWNLOAD_LINK} icon="android">{t(TranslationKeys.NAV_DOWNLOAD_APP)}</Button>
        </div>

        <MobileMenu client:load links={links} initialLocale={locale} />
      </div>
    </div>
  </div>
</nav>

<script>
  // Add simple scroll effect if needed in future (e.g. shrink logo)
</script>
